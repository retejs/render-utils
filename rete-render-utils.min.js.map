{"version":3,"file":"rete-render-utils.min.js","sources":["../src/utils.ts","../src/sockets-position/storage.ts","../src/sockets-position/base-socket-position.ts","../src/sockets-position/dom-socket-position.ts","../src/connection.ts"],"sourcesContent":["/* eslint-disable max-statements */\n\n/**\n* Calculates the center coordinates of a child element relative to a parent element.\n* @async\n* @param child The child element whose center coordinates need to be calculated.\n* @param parent The parent element relative to which the child element's center is calculated.\n* @returns Position of the child element's center\n* @throws Error if the child element has a null offsetParent.\n*/\nexport async function getElementCenter(child: HTMLElement, parent: HTMLElement) {\n  while (!child.offsetParent) {\n    await new Promise((res) => setTimeout(res, 0))\n  }\n\n  let x = child.offsetLeft\n  let y = child.offsetTop\n  let currentElement = child.offsetParent as HTMLElement | null\n\n  if (!currentElement) throw new Error('child has null offsetParent')\n\n  while (currentElement !== null && currentElement !== parent) {\n    x += currentElement.offsetLeft + currentElement.clientLeft\n    y += currentElement.offsetTop + currentElement.clientTop\n    currentElement = currentElement.offsetParent as HTMLElement | null\n  }\n  const width = child.offsetWidth\n  const height = child.offsetHeight\n\n  return {\n    x: (x + width / 2),\n    y: (y + height / 2)\n  }\n}\nexport class EventEmitter<T> {\n  listeners = new Set<(data: T) => void>()\n\n  emit(data: T) {\n    this.listeners.forEach(listener => listener(data))\n  }\n\n  listen(handler: (data: T) => void) {\n    this.listeners.add(handler)\n\n    return () => {\n      this.listeners.delete(handler)\n    }\n  }\n}\n","import { Position, Side } from '../types'\n\ntype SocketPayload = {\n  element: HTMLElement\n  side: Side\n  key: string\n  nodeId: string\n  position: Position // relative to node\n}\n\nexport class SocketsPositionsStorage {\n  elements = new Map<HTMLElement, SocketPayload[]>()\n\n  getPosition(data: { nodeId: string, key: string, side: Side }) {\n    const list = Array.from(this.elements.values()).flat()\n    const found = list.filter(item => {\n      return item.side === data.side && item.nodeId === data.nodeId && item.key === data.key\n    })\n\n    // eslint-disable-next-line no-console\n    if (found.length > 1) console.warn([\n      'Found more than one element for socket with same key and side.',\n      'Probably it was not unmounted correctly'\n    ].join(' '), data)\n\n    return found.pop()?.position || null\n  }\n\n  add(data: SocketPayload) {\n    const existing = this.elements.get(data.element)\n\n    this.elements.set(data.element, existing ? [\n      ...existing.filter(n => !(n.nodeId === data.nodeId && n.key === data.key && n.side === data.side)), data\n    ] : [data])\n  }\n\n  remove(element: SocketPayload['element']) {\n    this.elements.delete(element)\n  }\n\n  snapshot() {\n    return Array.from(this.elements.values()).flat()\n  }\n}\n","import { BaseSchemes, NodeId, Scope } from 'rete'\nimport { BaseAreaPlugin } from 'rete-area-plugin'\n\nimport { ExpectArea2DExtra, Position, Side } from '../types'\nimport { EventEmitter } from '../utils'\nimport { SocketsPositionsStorage } from './storage'\nimport { OnChange, SocketPositionWatcher } from './types'\n\ntype ListenerData = {\n  nodeId: string\n  side?: Side\n  key?: string\n}\n\n/**\n * Abstract class for socket position calculation. It can be extended to implement custom socket position calculation.\n * @abstract\n * @listens render\n * @listens rendered\n * @listens unmount\n * @listens nodetranslated\n * @listens noderesized\n */\nexport abstract class BaseSocketPosition<Schemes extends BaseSchemes, K> implements SocketPositionWatcher<Scope<never, [K]>> {\n  sockets = new SocketsPositionsStorage()\n  emitter = new EventEmitter<ListenerData>()\n  area: BaseAreaPlugin<Schemes, ExpectArea2DExtra<Schemes>> | null = null\n\n  /**\n   * The method needs to be implemented that calculates the position of the socket.\n   * @param nodeId Node ID\n   * @param side Side of the socket, 'input' or 'output'\n   * @param key Socket key\n   * @param element Socket element\n   */\n  abstract calculatePosition(nodeId: string, side: Side, key: string, element: HTMLElement): Promise<Position | null>\n\n  /**\n   * Attach the watcher to the area's child scope.\n   * @param scope Scope of the watcher that should be a child of `BaseAreaPlugin`\n   */\n  attach(scope: Scope<never, [K]>) {\n    if (this.area) return\n    if (!scope.hasParent()) return\n    this.area = scope.parentScope<BaseAreaPlugin<Schemes, ExpectArea2DExtra<Schemes>>>(BaseAreaPlugin)\n\n    // eslint-disable-next-line max-statements, complexity\n    this.area.addPipe(async context => {\n      if (context.type === 'rendered' && context.data.type === 'socket') {\n        const { nodeId, key, side, element } = context.data\n\n        const position = await this.calculatePosition(nodeId, side, key, element)\n\n        if (position) {\n          this.sockets.add({ nodeId, key, side, element, position })\n          this.emitter.emit({ nodeId, key, side })\n        }\n      } else if (context.type === 'unmount') {\n        this.sockets.remove(context.data.element)\n      } else if (context.type === 'nodetranslated') {\n        this.emitter.emit({ nodeId: context.data.id })\n      } else if (context.type === 'noderesized') {\n        const { id: nodeId } = context.data\n\n        await Promise.all(this.sockets.snapshot()\n          .filter(item => item.nodeId === context.data.id && item.side === 'output')\n          .map(async item => {\n            const { side, key, element } = item\n            const position = await this.calculatePosition(nodeId, side, key, element)\n\n            if (position) {\n              item.position = position\n            }\n          }))\n        this.emitter.emit({ nodeId })\n      } else if (context.type === 'render' && context.data.type === 'connection') {\n        const { source, target } = context.data.payload\n        const nodeId = source || target\n\n        this.emitter.emit({ nodeId })\n      }\n      return context\n    })\n  }\n\n  /**\n   * Listen to socket position changes. Usually used by rendering plugins to update the start/end of the connection.\n   * @internal\n   * @param nodeId Node ID\n   * @param side Side of the socket, 'input' or 'output'\n   * @param key Socket key\n   * @param change Callback function that is called when the socket position changes\n   */\n  listen(nodeId: NodeId, side: Side, key: string, change: OnChange) {\n    const unlisten = this.emitter.listen((data: ListenerData) => {\n      if (data.nodeId !== nodeId) return\n      if ((!data.key || data.side === side) && (!data.side || data.key === key)) {\n        const position = this.sockets.getPosition({ side, nodeId, key })\n\n        if (!position) return\n\n        const { x, y } = position\n        const nodeView = this.area?.nodeViews.get(nodeId)\n\n        if (nodeView) change({\n          x: x + nodeView.position.x,\n          y: y + nodeView.position.y\n        })\n      }\n    })\n\n    this.sockets.snapshot().forEach(data => {\n      if (data.nodeId === nodeId) this.emitter.emit(data)\n    })\n    return unlisten\n  }\n}\n","import { BaseSchemes } from 'rete'\n\nimport { Position, Side } from '../types'\nimport { getElementCenter } from '../utils'\nimport { BaseSocketPosition } from './base-socket-position'\n\n/**\n * Props for `DOMSocketPosition` class.\n */\nexport type Props = {\n  /**\n   * Allows to customize the position of the socket. By default, the position is shifted by 12px on the x-axis relative to the center of the socket.\n   * @param position Center position of the socket\n   * @param nodeId Node ID\n   * @param side Side of the socket, 'input' or 'output'\n   * @param key Socket key\n   * @returns Custom position of the socket\n   */\n  offset?: (position: Position, nodeId: string, side: Side, key: string) => Position\n}\n\n/**\n * Class for socket position calculation based on DOM elements. It uses `getElementCenter` function to calculate the position.\n */\nexport class DOMSocketPosition<Schemes extends BaseSchemes, K> extends BaseSocketPosition<Schemes, K> {\n  constructor(private props?: Props) {\n    super()\n  }\n\n  async calculatePosition(nodeId: string, side: Side, key: string, element: HTMLElement) {\n    const view = this.area?.nodeViews.get(nodeId)\n\n    if (!view?.element) return null\n    const position = await getElementCenter(element, view.element)\n\n    if (this.props?.offset) return this.props?.offset(position, nodeId, side, key)\n\n    return {\n      x: position.x + 12 * (side === 'input' ? -1 : 1),\n      y: position.y\n    }\n  }\n}\n\n/**\n * Wrapper function for `DOMSocketPosition` class.\n * @param props Props for `DOMSocketPosition` class\n */\nexport function getDOMSocketPosition<Schemes extends BaseSchemes, K>(props?: Props) {\n  return new DOMSocketPosition<Schemes, K>(props)\n}\n","import { Position } from './types'\n\n/**\n * Get classic SVG path for a connection between two points.\n * @param points Array of two points\n * @param curvature Curvature of the connection\n */\nexport function classicConnectionPath(points: [Position, Position], curvature: number) {\n  const [{ x: x1, y: y1 }, { x: x2, y: y2 }] = points\n  const vertical = Math.abs(y1 - y2)\n  const hx1 = x1 + Math.max(vertical / 2, Math.abs(x2 - x1)) * curvature\n  const hx2 = x2 - Math.max(vertical / 2, Math.abs(x2 - x1)) * curvature\n\n  return `M ${x1} ${y1} C ${hx1} ${y1} ${hx2} ${y2} ${x2} ${y2}`\n}\n\n/**\n * Get loop SVG path for a connection between two points.\n * @param points Array of two points\n * @param curvature Curvature of the loop\n * @param size Size of the loop\n */\nexport function loopConnectionPath(points: [Position, Position], curvature: number, size: number) {\n  const [{ x: x1, y: y1 }, { x: x2, y: y2 }] = points\n  const k = y2 > y1 ? 1 : -1\n  const scale = size + Math.abs(x1 - x2) / (size / 2)\n  const middleX = (x1 + x2) / 2\n  const middleY = y1 - k * scale\n  const vertical = (y2 - y1) * curvature\n\n  return `\n        M ${x1} ${y1}\n        C ${x1 + scale} ${y1}\n        ${x1 + scale} ${middleY - vertical}\n        ${middleX} ${middleY}\n        C ${x2 - scale} ${middleY + vertical}\n        ${x2 - scale} ${y2}\n        ${x2} ${y2}\n    `\n}\n"],"names":["getElementCenter","_x","_x2","_getElementCenter","apply","this","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","child","parent","x","y","currentElement","width","height","wrap","_context","prev","next","offsetParent","Promise","res","setTimeout","offsetLeft","offsetTop","Error","clientLeft","clientTop","offsetWidth","offsetHeight","abrupt","stop","EventEmitter","_classCallCheck","_defineProperty","Set","_createClass","key","value","data","listeners","forEach","listener","handler","_this","add","SocketsPositionsStorage","Map","_found$pop","found","Array","from","elements","values","flat","filter","item","side","nodeId","length","console","warn","join","pop","position","existing","get","element","set","concat","_toConsumableArray","n","BaseSocketPosition","scope","area","hasParent","parentScope","BaseAreaPlugin","addPipe","_ref","_callee2","context","_context$data","_nodeId","_key","_side","_element","_nodeId2","_context$data$payload","source","target","_nodeId3","_context2","type","calculatePosition","sent","sockets","emitter","emit","remove","id","all","snapshot","map","_ref2","payload","change","_this2","unlisten","listen","_this2$area","getPosition","nodeView","nodeViews","DOMSocketPosition","_BaseSocketPosition","_inherits","_calculatePosition","_super","_createSuper","props","call","_this$area","_this$props","_this$props2","view","offset","_x3","_x4","points","curvature","_points","_slicedToArray","_points$","x1","y1","_points$2","x2","y2","vertical","Math","abs","hx1","max","hx2","size","_points2","_points2$","_points2$2","k","scale","middleX","middleY"],"mappings":"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"}